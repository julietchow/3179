{
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "description": "A simple pie chart with embedded data.",
    "data": {
        "url": "https://raw.githubusercontent.com/julietchow/3179/main/data/c.csv"
    },
    "title": {
        "text": "Top 10 Energy Consumers",
        "fontSize": 14,
        "fontWeight": "bold"
      },
    "params":[
        {
          "name": "select_year",
          "value" : 2021,
          "bind": {"input":"range", "min":2000,"max":2021,"step":1,"name":"Year: "}
        }
    ],
    "transform": [
        {"filter": "datum.Year == select_year"},
        {"window": [{"op": "count", "as": "count"}]},
        {"filter": "datum.count <= 10"}
    ],
    "layer":[
        {
            "mark" :{"type":"bar"},
            "encoding":
            {
                "x":{
                    "field": "total_consumption",
                    "title": "Total Energy Consumption Per Capita (Sextillion kWh)",
                    "type": "quantitative"
                },
                "y":{
                    "field": "country",
                    "title":"",
                    "type": "nominal",
                    "sort": {
                        "field": "total_consumption",
                        "order": "descending"
                    }
                },
                "tooltip":
                [
                    {"field": "total_consumption", "title": "Consumption Per Capita", "type": "quantitative","format":",.2f"}
                ]
            }

        }
    ]
}